<html>
<head>
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="../streamr-client/streamr-client.js"></script>

	<script type="text/javascript">
		var client

		window.consoleLoggingEnabled = true

		function SubCounter($el, client, resend_last) {
			var counter = 0

			// "XvGvByswSCe0AvEFM9Z8LA", canvas topic
			// "t3J6bB2SRWmnnJmvm4-anQ", table topic
			// "YpTAPDbvSAmj-iCUYz-dxA", hsl topic

/*			var canvasSub = client.subscribe(
					"XvGvByswSCe0AvEFM9Z8LA",
					function(message) {
						counter++
						$el.html(counter)
					},
					{resend_last: 0}
			)

			var tableSub = client.subscribe(
					"t3J6bB2SRWmnnJmvm4-anQ",
					function(message) {
						counter++
						$el.html(counter)
					},
					{resend_last: 0}
			)*/

			var hslSub = client.subscribe(
				"YpTAPDbvSAmj-iCUYz-dxA",
				function(message) {
					counter++
					$el.html(counter)
				},
				{resend_last: 0}
			)

		}

		$(document).ready(function() {
			window.consoleLoggingEnabled = true
			client = new StreamrClient({url: "ws://localhost:8889/api/v1/ws"})

			new SubCounter($("#sub1-count"), client, 0)
			//new SubCounter($("#sub2-count"), client, 100)

			client.connect()

			$("#add").click(function() {
				var div = $("<div></div>")
				$("body").append(div)
				new SubCounter(div, client, parseInt($("#count").val()))
			})
		})
	</script>
</head>
<body>
	<input type="text" id="count">
	<button id="add">Add</button>
	<div id="sub1-count"></div>
	<div id="sub2-count"></div>
</body>
</html>