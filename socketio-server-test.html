<html>
<head>
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="node_modules/socket.io-client/socket.io.js"></script>
	<script type="text/javascript" src="../streamr-client/streamr-client.js"></script>

	<script type="text/javascript">
		var client

		function SubCounter($el, client, resend_last) {
			var counter = 0
			var sub = client.subscribe(
				"streamr-metrics",
				function(message) {
					counter++
					$el.html(counter)
				},
				{resend_last: resend_last}
			)
		}

		$(document).ready(function() {
			client = new StreamrClient("http://localhost:8889")

			new SubCounter($("#sub1-count"), client, 0)
			//new SubCounter($("#sub2-count"), client, 100)

			client.connect()

			$("#add").click(function() {
				var div = $("<div></div>")
				$("body").append(div)
				new SubCounter(div, client, parseInt($("#count").val()))
			})
		})
	</script>
</head>
<body>
	<input type="text" id="count">
	<button id="add">Add</button>
	<div id="sub1-count"></div>
	<div id="sub2-count"></div>
</body>
</html>